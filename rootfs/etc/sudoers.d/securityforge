# SecurityForge Linux - Configuração sudo ultra-avançada
# Defaults gerais
Defaults        env_reset
Defaults        mail_badpass
Defaults        secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/snap/bin:/opt/securityforge/tools:/opt/securityforge/scripts"
Defaults        use_pty
Defaults        log_input,log_output
Defaults        iolog_dir=/var/log/sudo-io
Defaults        iolog_file=%{seq}
Defaults        log_year,logfile=/var/log/sudo.log
Defaults        passwd_tries=3
Defaults        passwd_timeout=1
Defaults        timestamp_timeout=15
Defaults        requiretty
Defaults        !visiblepw
Defaults        always_set_home
Defaults        match_group_by_gid
Defaults        always_query_group_plugin
Defaults        env_keep += "DISPLAY XAUTHORITY"
Defaults        env_keep += "HOME MAIL USER USERNAME"
Defaults        env_keep += "LANG LC_* LANGUAGE LINGUAS _XKB_CHARSET"
Defaults        env_keep += "XAPPLRESDIR XFILESEARCHPATH XUSERFILESEARCHPATH"

# Root privileges
root    ALL=(ALL:ALL) ALL

# Admin group
%admin ALL=(ALL) ALL

# Sudo group completo
%sudo   ALL=(ALL:ALL) ALL

# SecurityForge user - permissões seletivas para ferramentas de segurança
secforge ALL=(ALL) NOPASSWD: /usr/bin/nmap, /usr/bin/masscan, /usr/bin/zmap
secforge ALL=(ALL) NOPASSWD: /usr/bin/nikto, /usr/bin/sqlmap, /usr/bin/w3af
secforge ALL=(ALL) NOPASSWD: /usr/bin/wireshark, /usr/bin/tshark, /usr/bin/tcpdump
secforge ALL=(ALL) NOPASSWD: /usr/bin/aircrack-ng, /usr/bin/airmon-ng, /usr/bin/airodump-ng
secforge ALL=(ALL) NOPASSWD: /usr/bin/john, /usr/bin/hashcat, /usr/bin/hydra
secforge ALL=(ALL) NOPASSWD: /usr/bin/metasploit, /usr/bin/msfconsole, /usr/bin/msfvenom
secforge ALL=(ALL) NOPASSWD: /opt/securityforge/tools/*/*
secforge ALL=(ALL) NOPASSWD: /opt/securityforge/scripts/*
secforge ALL=(ALL) NOPASSWD: /usr/local/bin/*
secforge ALL=(ALL) NOPASSWD: /bin/systemctl restart networking
secforge ALL=(ALL) NOPASSWD: /bin/systemctl restart ssh
secforge ALL=(ALL) NOPASSWD: /bin/systemctl restart ufw
secforge ALL=(ALL) NOPASSWD: /usr/bin/docker, /usr/bin/docker-compose, /usr/bin/podman
secforge ALL=(ALL) NOPASSWD: /usr/bin/mount, /usr/bin/umount
secforge ALL=(ALL) NOPASSWD: /sbin/iptables, /sbin/ip6tables, /usr/sbin/ufw
secforge ALL=(ALL) NOPASSWD: /usr/bin/tcpdump, /usr/bin/ncat, /usr/bin/netcat

# Alias para comandos organizados
Cmnd_Alias SECURITY_SCANNERS = /usr/bin/nmap, /usr/bin/masscan, /usr/bin/nikto, /usr/bin/sqlmap, /usr/bin/nuclei
Cmnd_Alias NETWORK_TOOLS = /usr/bin/wireshark, /usr/bin/tcpdump, /usr/bin/netstat, /usr/bin/ss
Cmnd_Alias WIRELESS_TOOLS = /usr/bin/aircrack-ng, /usr/bin/airmon-ng, /usr/bin/wash, /usr/bin/reaver
Cmnd_Alias PASSWORD_TOOLS = /usr/bin/john, /usr/bin/hashcat, /usr/bin/hydra, /usr/bin/medusa
Cmnd_Alias EXPLOITATION_TOOLS = /usr/bin/msfconsole, /usr/bin/msfvenom, /usr/bin/searchsploit
Cmnd_Alias SYSTEM_TOOLS = /bin/systemctl, /usr/bin/service, /sbin/iptables, /usr/sbin/ufw
Cmnd_Alias CONTAINER_TOOLS = /usr/bin/docker, /usr/bin/docker-compose, /usr/bin/podman

secforge ALL=(ALL) NOPASSWD: SECURITY_SCANNERS, NETWORK_TOOLS, WIRELESS_TOOLS
secforge ALL=(ALL) NOPASSWD: PASSWORD_TOOLS, EXPLOITATION_TOOLS, SYSTEM_TOOLS, CONTAINER_TOOLS

# Grupos especializados
%wireshark ALL=(ALL) NOPASSWD: /usr/bin/wireshark, /usr/bin/tshark, /usr/bin/tcpdump
%docker ALL=(ALL) NOPASSWD: /usr/bin/docker, /usr/bin/docker-compose
%pcap ALL=(ALL) NOPASSWD: /usr/bin/tcpdump, /usr/bin/tshark
